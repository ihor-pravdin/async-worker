name: CI

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  embed-code:

    runs-on: ubuntu-latest

    inputs:
      commit_author:
        description: Value used for the commit author. Defaults to the username of whoever triggered this workflow run.
        required: false
        default: ${{ github.actor }} <${{ github.actor }}@users.noreply.github.com>
      commit_user_email:
        description: Email address used for the commit user
        required: false
        default: actions@github.com
      commit_message:
        description: Commit message
        required: false
        default: Apply automatic changes
      branch:
        description: Git branch name, where changes should be pushed too.
        required: false
        default: ${{ github.ref }}
      output_file_paths:
        description: Output markdown file paths.
        required: false
        default: '[./README.md]'
      categories:
        description: Categories to automatically sync or transform its contents in the markdown files.
        required: false
        default: '[code-block,json-to-html-table,workflow-artifact-table,markdown]'

    steps:
    - run: wget https://raw.githubusercontent.com/dineshsonachalam/markdown-autodocs/master/action.py
      shell: bash
    - run: python3 action.py -repo '${{ github.repository }}' -access_token '${{ github.token }}' -commit_author '${{ github.actor }}' -commit_user_email '${{ actions@github.com }}' -commit_message 'Apply automatic changes' -branch '${{ github.ref }}' -output_file_paths '[./README.md]' -categories ''[code-block,json-to-html-table,workflow-artifact-table,markdown]'
      shell: bash
#    - uses: actions/checkout@v3
#    - uses: actions/setup-node@v3
#      with:
#        node-version: v12.11.1
#        cache: 'npm'


#    - run: npm i -g markdown-autodocs

#    - name: Markdown autodocs
#      uses:  dineshsonachalam/markdown-autodocs@v1.0.3